\section{Hiding}

Der Hiding-Operator wandelt Outputs in $\tau$s um. Somit hat das Hiding auf die
Divergenz-Eigenschaft im Vergleich zu den betrachteten Eigenschaften aus den
beiden vorangegangen Kapiteln deutlich größere Auswirkungen. Die Menge der
divergenten Zustände kann sich durch das Internalisieren vergrößern. Es kann
ein Zustand divergent werden, wenn von diesem bereits lokal ein divergenter
Zustand aus erreichbar war oder wenn er eine unendliche Folge von Aktionen aus
$X\cup \{\tau\}$ ausführen konnte. Durch die zusätzlichen Divergenz"=Zustände
vergrößern sich alle Trace-Mengen, die in der Präkongruenz \DRel{} betrachtet
werden.\\
Um den zusätzlichen Aufwand der Untersuchung möglichst gering zu halten, wird
dieses Teilkapitel auf endliche \MEIO{}s beschränkt. Falls man unendlich große
\MEIO{}s zulassen würde, müsste man an anderen Stellen
Endlichkeits"=Voraussetzungen machen.\\
Die Menge $X$ muss eine Teilmenge der Outputs $O$ sein, für einen endlichen
\MEIO{} kann $X$ ebenfalls nur endlich sein. Um eine endliche Menge von
Aktionen zu internalisieren, kann man jede Aktion einzeln aus dem entsprechend
\MEIO{} entfernen. Der folgende Satz kann also darauf beschränkt werden, dass
nur ein einzelner Output verborgen werden soll. $P/o$ soll dabei für $P/\{o\}$
stehen. Die Menge $\EDT _{P/o}$ kann aus $\EDT _P$ konstruiert werden. Im
Allgemeinen ist die Menge $\EDT _{P/o}$ jedoch größer wie die Menge $\{w\in
(\Sigma\backslash \{o\})^*\mid \exists w'\in \EDT(P): w'|_{\Sigma\backslash
\{o\}} = w\}$, da an Zuständen, die in $P$ nicht divergent sind und von denen
aus unendliche Folgen von $\tau$s und $o$s mit unendlich vielen $o$s möglich
sind, erst durch das Hiding Divergenz entsteht. Die anderen Trace-Mengen müssen
deshalb mit der neuen \EDT{} Menge geflutet werden.


\begin{Satz}[Divergenz-Präkongruenz bzgl.\ Internalisierung]
  \label{DivHidingSatz}
  Seien $P_1$ und $P_2$ endliche \MEIO{}s für die $P_1\DRel P_2$ gilt, dann
  folgt auch die Gültigkeit von $P_1/X\DRel P_2/X$. Die Relation \DRel{} ist
  also eine Präkongruenz bezüglich $\cdot /\cdot$ für endliche \MEIO{}s. Es
  gilt für die Sprachen und Traces:
  \begin{enumerate}[(i)]
    \item $L(P/o) = \{w\in (\Sigma\backslash \{o\})^*\mid \exists w'\in L(P):
      w'|_{\Sigma\backslash \{o\}} = w\}$,
    \item $\EDT (P/o) = \cont (\prune (\{w\in (\Sigma\backslash \{o\})^*\mid
      \exists w':w'|_{\Sigma\backslash \{o\}} = w\land \forall n\geq 0:
      w'o^n\in\EDL (P)\}))$,
    \item $\EDL (P/o) = \{w\in (\Sigma\backslash \{o\})^*\mid \exists w'\in
      \EDL(P): w'|_{\Sigma\backslash \{o\}} = w\} \cup \EDT (P/o)$,
    \item $\StQT (P/o) = \{w\in (\Sigma\backslash \{o\})^*\mid \exists w'\in
      \StQT(P): w'|_{\Sigma\backslash \{o\}} = w\}$,
    \item $\QDT (P/o) = \{w\in (\Sigma\backslash \{o\})^*\mid \exists w'\in
      \QDT(P): w'|_{\Sigma\backslash \{o\}} = w\} \cup \EDT (P/o)$.
  \end{enumerate}
\end{Satz}
\begin{proof}
  Die Präkongruenz-Eigenschaft lässt sich wie bei den
  Sätzen~\ref{FehlerHidingSatz} und~\ref{StilleHidingSatz} aus den Aussagen
  über die Sprachen und Traces folgern. Somit sollen nun zunächst (i) bis (v)
  nachgewiesen werden. Der Punkt (i) folgt aus (i) von
  Satz~\ref{FehlerHidingSatz} und der Punkt (iv) aus (iv) von
  Satz~\ref{StilleHidingSatz}.

  (ii) \glqq $\subseteq$\grqq{}:\\
  Beide Seiten sind abgeschlossen gegenüber \cont{} und die rechte Seite auch
  unter \prune{}. Somit genügt
  es ein Element $w$ aus $\MIT (P/o)\cup \StET (P/o)\cup \StDT (P/o)$ zu
  betrachten.
  \begin{itemize}
    \item Fall 1 ($w\in\MIT (P/o)$): Durch das Präfix $v$ von $w$ ohne den
      letzten Buchstaben $a\in I$, wird ein Zustand $p$ erreicht, für den $a$
      nicht sichergestellt ist. Mit Lemma~\ref{TraceHidingLem} folgt, dass der
      Zustand $p$ auch in $P$ durch ein $v'$ mit $v'|_{\Sigma\backslash\{o\}} =
      v$ erreichbar ist. Der Input $a$ kann wegen Definition~\ref{HidingDef}
      auch für $P$ im Zustand $p$ nicht sichergestellt sein. Es gilt also
      $w'\in\MIT (P) \subseteq \EDT (P) \subseteq \EDL (P)$ für $w' = v'a =
      w|_{\Sigma\backslash\{o\}}$. Wegen des Abschlusses unter \cont{} der
      Menge \EDT{} gilt auch $w'o^n\in\EDT (P)\subseteq\EDL (P)$ für alle $n
      \in \mathbb{N}$.
    \item Fall 2 ($w\in \StET (P/o)\cup \StDT (P/o)$): Es gibt also einen mit
      $w$ beschrifteten Ablauf in $P/o$, der zu einem Zustand $p$ führt, der in
      $E_{P/o}\cup Div_{P/o}$ enthalten ist. Derselbe Zustand $p$ kann wegen
      Lemma~\ref{TraceHidingLem} in $P$ durch ein $w'$ erreicht werden mit
      $w'|_{\Sigma\backslash\{o\}} = w$.\\
      Falls von $p$ aus in $P$ ein Fehler- oder Divergenz"=Zustand lokal
      erreichbar ist, gilt $w'\in \EDT (P)\subseteq\EDL (P)$. Da die Menge
      \EDT{} unter \cont{} abgeschlossen ist, gilt dann auch $w'o^n\in\EDT
      (P)\subseteq\EDL (P)$ für alle $n\in\mathbb{N}$.\\
      Der Zustand $p$ kann jedoch in $P$ auch ein Zustand sein, von dem aus
      weder ein Fehler noch Divergenz lokal erreicht werden kann. Es muss also
      durch das Internalisieren des Outputs $o$ in $P/o$ ein Divergenz"=Zustand
      entstanden sein. Da nur $o$s in $\tau$s umgewandelt wurden, muss von $p$
      aus in $P$ eine unendliche Folge bestehend aus $o$s und $\tau$s mit
      unendliche vielen $o$s ausführbar sein, damit durch das Anwenden des
      Hiding"=Operators neue Divergenz entstehen kann. Es muss also $w'o^n$ für
      alle $n\in\mathbb{N}$ in $P$ ausführbar sein. Somit gilt $\forall n\geq
      0: w'o^n\in\EDL (P)$.
  \end{itemize}

  (ii)  \glqq $\supseteq$\grqq{}:\\
  Für ein beliebiges $w'$ für das $w'o^n\in \EDL (P)$ für alle $n\in\mathbb{N}$
  gilt, kann unterschieden werden, ob es ein bestimmtes $m\in\mathbb{N}$ gibt,
  so dass $w'o^m$ in $\EDT (P)$ enthalten ist oder ob $w'o^n$ für alle $n\geq
  0$ in der Sprache von $P$ enthalten ist.
  \begin{itemize}
    \item Fall 1 ($\exists m\in\mathbb{N}: w'o^m\in\EDT (P)$): Es muss ein
      Präfix $v'$ von $w'$ geben, das in $\PrET (P)\cup \MIT (P)\cup \PrDT (P)$
      enthalten ist. Für $v'\in\PrET (P)\cup \MIT (P) \subseteq\ET (P)$ muss
      mit Satz~\ref{FehlerHidingSatz} (ii) $v'|_{\Sigma\backslash\{o\}}$ in
      $\ET (P/o)$ enthalten sein. Mit einer analogen Argumentation wie in
      Satz~\ref{FehlerHidingSatz} (ii) kann auch für ein $v'$ aus $\PrDT (P)$
      $v'|_{\Sigma\backslash\{o\}}\subseteq\DT (P/o)$ gefolgert werden. Da
      \EDT{} unter der Fortsetzungs-Funktion \cont{} abgeschlossen ist, gilt
      $w'|_{\Sigma\backslash\{o\}}\in\EDT (P/o)$.
    \item Fall 2 ($\forall n\in\mathbb{N}: w'o^n\in L (P)$): Da $P$ ein
      endlicher \MEIO{} ist, muss für $n = |P|$ mindestens ein Zustand entlang
      des Ablaufes von $o^n$, der nach $w'$ ausführbar ist, doppelt auftauchen.
      Der Zustand, der durch $w'$ in $P$ erreicht ist, ist nach dem
      Internalisieren von $o$ in $P/o$ divergent. Dieser Zustand wird in $P/o$
      durch $w'|_{\Sigma\backslash\{o\}}$ erreicht, wegen
      Lemma~\ref{TraceHidingLem}. Es gilt also $w'|_{\Sigma\backslash\{o\}} \in
      \EDT (P/o)$.
  \end{itemize}

  (iii) und (v) \glqq $\subseteq$\grqq{}:\\
  Es gilt $\EDL = L \cup \EDT$ und $\QDT = \StQT \cup \EDT$ für $P$ und $P/X$.
  Somit lässt sich diese Inklusionsrichtung der Punkte analog zu den Aussagen
  aus Satz~\ref{FehlerHidingSatz} und~\ref{StilleHidingSatz} beweisen, da der
  Punkt (ii) dieses Satzes bereits nachgewiesen wurde.

  (iii) \glqq $\supseteq$\grqq{}:\\
  $\EDT (P/o)\subseteq\EDL (P/o)$ gilt aufgrund der Definition der Menge
  \EDL{}. Es sollen hier somit nur Elemente aus $\{w\in (\Sigma\backslash
  \{o\})^*\mid \exists w'\in \EDL(P): w'|_{\Sigma\backslash \{o\}} = w\}$
  betrachtet werden. Sei $w'$ ein beliebiges Element aus $\EDL _P$. Nach
  Definition kann $w'\in L_P$ oder $w'\in\EDT _P$ gelten. Für $w'\in L_P$ folgt
  mit (i) bereits $w = w'|_{\Sigma\backslash \{o\}}\in L_{P/o}\subseteq\EDL
  _{P/o}$. Es wird im Folgenden also davon ausgegangen, dass das $w'$ in $\EDT
  _P$ enthalten ist. Es gibt also ein Präfix $v'$ von $w'$, das in $\PrET_P
  \cup \MIT _P\cup \PrDT _P$ enthalten ist. Mit einer analogen Begründung wie
  in (ii) Fall 1, folgt daraus $w'|_{\Sigma\backslash\{o\}} \in \EDT _{P/o}
  \subseteq \EDL _{P/o}$.

  (v) \glqq $\supseteq$\grqq{}:\\
  Da \QDT{} die Vereinigung der Menge \StQT{} und \EDT{} ist, folgt diese
  Inklusionsrichtung des Punktes (v) aus (iv) und der Argumentation im Beweis
  der selben Inklusionsrichtung des Punkts (iii).

  Da $P_1$ und $P_2$ endliche sein müssen, gibt es auch nur endliche viele
  Outputs, die man in ihnen verbergen kann. Die Menge $X$ muss also endlich
  sein. Für jedes Element $o$ aus $X$ kann mit den Punkten (ii) bis (v) aus
  $P_1\DRel P_2$ gefolgert werden, dass auch $P_1/o\DRel P_2/o$ gilt. In dem
  man immer ein weiteren Output internalisiert, kann am Ende auch $P_1/X\DRel
  P_2/X$ aus der Voraussetzungen $P_1\DRel P_2$ für endliche \MEIO{} $P_1$ und
  $P_2$ gefolgert werden.\\
  Somit bleibt die Relation \DRel{} unter Anwendung des Hiding-Operators
  erhalten und ist somit bezüglich diesem eine Präkongruenz.
\end{proof}

Die Parallelkomposition mit Internalisierung ist auf Basis der
Parallelkomposition $\cdot \|\cdot$ und des Hiding-Operators $\cdot /\cdot$
in~\ref{DefParallelkompInternal} definiert. Diese beiden Operatoren sind, wie
in Korollar~\ref{DivPraekonKor} und Satz~\ref{DivHidingSatz} nachgewiesen
wurde, Präkongruenzen bezüglich der Relation \DRel{}. Somit ist auch $\cdot
|\cdot$ eine Präkongruenz bezüglich dieser Relation.

\begin{Kor}[Divergenz-Präkongruenz mit Internalisierung]
  Die Relation \DRel{} ist eine Präkongruenz bezüglich $\cdot |\cdot$.
\end{Kor}
