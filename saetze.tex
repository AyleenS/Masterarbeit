\section{Allgemeine Folgerungen}

\begin{Prop}[Sprache und Implementierungen]
  \label{LImpProp}
  Für die Sprache eines \MEIO{}s $P$ gilt $L(P) \subseteq \underset{P'\in\asimp
  (P)}{\bigcup} L(P')$.
\end{Prop}
\begin{proof}\mbox{}\\
  Sei $P'$ die as-Implementierung von $P$, die alle may- und must-Transitionen
  von $P$ implementiert. Die Definition von $P'$ lautet also:
  \begin{itemize}
    \item $P'=P$,
    \item $p'_0=p_0$,
    \item $I_{P'}=I_P$ und $O_{P'}=O_P$,
    \item $\must _{P'} =\may _{P'} = \may _P$,
    \item $E_{P'}=\emptyset$.
  \end{itemize}
  Die entsprechende starke as"=Verfeinerungs"=Relation $\mathcal{R}$, die
  zwischen $P'$ und $P$ gilt, ist die Identitäts-Relation zwischen den
  Zuständen der Transitionssysteme. Für~\ref{SimDef}~3.\ betrachten wir $(p,p)
  \in\mathcal{R}$ mit $p\may[\alpha]_{P'} p'$ in $P'$. Diese Transition muss
  auch in $P$ existieren und da $\mathcal{R}$ die Identitäts-Relation ist auch
  $(p',p')\in\mathcal{R}$ gelten. Alle must"=Transitionen in $P$ haben zugrunde
  liegende may"=Transitionen. Es gibt also zu jeder must"=Transition $p
  \must[\alpha]_P p'$ in $P$ auch die Transition $p\must[\alpha]_{P'} p'$, wenn
  $(p,p)$ in $\mathcal{R}$ enthalten ist. Es folgt dann auch $(p',p') \in
  \mathcal{R}$ und dadurch ist auch~\ref{SimDef}~2.\ erfüllt. Der erste Punkt
  von~\ref{SimDef} gilt, da $E_{P'}$ leer ist.\\
  Für alle $w\in L(P) = \left\{w\in \Sigma ^* \mid p_0\weakmay[w]_P\right\}$
  gilt $w\in L(P') = \left\{w\in \Sigma ^* \mid p'_0 \weakmust[w]_{P'}
  \right\}$, da alle Transitionen von $P$ in $P'$ implementiert werden.
\end{proof}

\begin{Prop}[Sprache der Parallelkomposition]
  \label{LParallelProp}
  Für zwei komponierbare \MEIO{}s $P_1$ und $P_2$ gilt: $L_{12} := L(P_{12}) =
  L_1\|L_2$.
\end{Prop}
\begin{proof}
  Jedes Wort, dass in $L_{12}$ enthalten ist, hat einen einen entsprechenden
  Ablauf, der in $P_{12}$ ausführbar ist. Dieser Ablauf kann auf Abläufe von
  $P_1$ und $P_2$ projiziert werden und die Projektionen sind dann in $L_1$ und
  $L_2$ enthalten.\\
  In einer Parallelkomposition werden die Wörter der beiden \MEIO{}s gemeinsam
  ausgeführt, falls es sich um synchronisierte Aktionen handelt, und
  verschränkt sequenziell, wenn es sich um unsynchronisierte Aktionen handelt.
  Somit sind alle Wörter aus $L_1\|L_2$ auch Wörter der Parallelkomposition
  $L(P_{12})$.
\end{proof}

\begin{Lem}[w-as-Verfeinerung und Parallelkomposition]
  \label{schwVerfParallelLem}
  Für zwei komponierbar \MEIO{}s $P_1$ und $P_2$ gilt, falls $P'_1$ eine
  schwache as"=Verfeinerung von $P_1$ ist, dann muss $P'_1\|P_2$ keine
  schwache as"=Verfeinerung von $P_1\|P_2$ sein. Jedoch für eine Relation
  $\mathcal{R}_{12}$, für die $((p'_1,p_2),(p_1,p_2)) \in \mathcal{R}_{12}$
  genau dann gilt, wenn $p_2 \in P_2$ und $(p'_1,p_1)\in\mathcal{R}_1$ für die
  schwache as"=Verfeinerungs"=Relation von $P'_1$ bzgl.\ $P_1$, dann sind für
  $\mathcal{R}_{12}$ die Aussagen 2.\ bis 5.\ aus der Definition~\ref{wSimDef}
  erfüllt.
\end{Lem}
\begin{proof}
  Um zu beweisen, dass $\mathcal{R}_{12}$ eine Relation nach~\ref{wSimDef} bis
  auf den ersten Punkt der Definition ist, müssen die Aussagen 2 bis 5 geprüft
  werden und gezeigt werden, dass 1 im allgemeinen nicht erfüllt ist.\\
  Für alle folgenden Fälle wird $((p'_1,p_2),(p_1,p_2))\in\mathcal{R}_{12}$
  mit $(p_1,p_2)\notin E_{12}$ vorausgesetzt.
  \begin{enumerate}
    \item Dieser Punkt der Definition~\ref{wSimDef} ist im Allgemeinen nicht
      erfüllt. Es gilt also nicht unbedingt, dass $(p'_1,p_2)$ kein Element von
      $E_{P'_1\|P_2}$ ist. Deshalb muss $P'_1\|P_2$ keine schwache
      as"=Verfeinerung von $P_1\|P_2$ sein.\\
      Dies folgt direkt aus der Voraussetzung, dass $(p_1,p_2)\notin E_{12}$
      für das Zustands-Tupel $((p'_1,p_2),(p_1,p_2))$ aus $\mathcal{R}_{12}$
      gilt. Indem man auf $\mathcal{R}_{12}$ die Definition von oben anwendet,
      erhält man $(p'_1,p_1)\in\mathcal{R}_1$ und $p_2\in P_2$. Die $p_j$
      dürfen beide $j$-Werte ($j\in\{1,2\}$) keine Fehler-Zustände sein, da
      sonst auch $(p_1,p_2)$ ein solcher wäre. Somit folgt $p_2\notin E_2$ und
      mit Definition~\ref{wSimDef}~1.\ auch $p'_1\notin E_1$. Die Zustände
      $p'_1$ und $p_2$ in Parallelkomposition können also keinen geerbten
      Fehler produzieren. Jedoch könnte $(p'_1,p_2)$ aufgrund eines nicht
      erzwungenen Inputs ein neuer Fehler-Zustand sein. Der nicht
      sichergestellte Input kann in beiden Systemen auftreten. Für den Fall,
      dass $P'_1$ einen Output hat, für den $P_2$ nicht den passenden Input
      sicherstellt gilt $p'_1\may[a]_{P'_1}$ und $p_2\nmust[a]_2$ für ein $a$
      aus $O_1\cap I_2$. $\mathcal{R}_1$ erzwingt mit~\ref{wSimDef}~5.\ die
      schwache Ausführbarkeit des Outputs $a$ in $P_1$, d.h.\ $p_1
      \weakmay[a]_1$. Da dieser Output nur schwach ausführbar sein muss, kann
      es in der Parallelkomposition von $P'_1\|P_2$ zu einem neuen
      Kommunikationsfehler kommen, der in $P_1\|P_2$ keiner ist.\\
      Ein Gegenbeispiel für diesen Punkt ist in Abbildung~\ref{bsp1wSim}
      dargestellt. Hierfür soll $a$ im Schnitt der Outputs $O_1$ von $P_1$
      bzw.\ $P'_1$ und der Inputs $I_2$ von $P_2$ enthalten sein. Die Relation
      $\mathcal{R}_1$ enthält die Zustands-Tupel $(p'_{01},p_{01})$ und
      $(p'_1,p_1)$. Somit ist $((p'_{01},p_{02}),(p_{01},p_{02}))$ in
      $\mathcal{R}_{12}$ enthalten und es gilt $(p_{01},p_{02})\notin E_{12}$.
      Jedoch ist $(p'_{01},p_{02})$ trotzdem ein Fehler-Zustand in der
      Parallelkomposition von $P'_1$ und $P_2$.\\
      Es wäre auch möglich, dass $P_1$ ebenfalls eine Implementierung ist. Die
      must"=$\tau$-Transition würde dann eine schwache Implementierung in
      $P'_1$ fordern, jedoch muss es dafür keine echte Transition in $P'_1$
      geben, da $\tau$ die interne Aktion ist. Die Implementierung von $a$
      würde ebenfalls schwach gefordert werden, ist jedoch bereits stark
      vorhanden. $P_1\|P_2$ würde mit der must"=$\tau$"=Transition dann
      ebenfalls zu einer Implementierung werden. Die must"=$a$"=Transition in
      $P'_1$ könnte auch eine may"=Transition sein, solange die $a$-Transition
      in $P_1$ keine must"=Transition ist.\\
      Um das in diesem Punkt auftretende Problem zu lösen könnte man die
      Definition der Parallelkomposition verändern. Es wäre denkbar, dass alle
      Zustände, die lokal Fehler-Zustände erreichen können ebenfalls bereits
      als Fehler angesehen werden. Jedoch stellt dies eine stärkere Forderung.
      Spezielle in Implementierungen ist die Forderung stärkere, wie die der
      \EIO{}s in z.B.~\cite{Schinko2016BA}. Dieser Ansatz käme jedoch dem
      Vorgehen des Abschneidens der Fehler-Zustände mit ihren lokalen
      Vorgängern in~\cite{Vogler2016MIA3} näher.

    \begin{figure}[htbp]
      \begin{center}
        \begin{tikzpicture}[shorten >=1pt,auto,node distance=2.5cm]
          \node [initial,initial text=$P_1$:] (p01) at (0,0) {$p_{01}$};
          \node (p) [right of=p01] {$p$};
          \node (p1) [right of=p] {$p_1$};

          \path[->]
          (p01) edge[dashed] node{$\tau$} (p)
          (p) edge[dashed] node{$a!$} (p1)
          ;

          \node [initial,initial text=$P'_1$:] (p'01) at (9,0) {$p'_{01}$};
          \node (p'1) [right of=p'01] {$p'_1$};

          \path[->]
          (p'01) edge node{$a!$} (p'1)
          ;

          \node [initial,initial text=$P_2$:] (p02) at (0,-1) {$p_{02}$};

          \node [initial,initial text=$P_1\|P_2$:] (p0102) at (0.4,-2)
          {$p_{01}\|p_{02}$};
          \node (p01p) [rectangle, draw, right of=p0102] {$p_{01}\|p \in
          E_{12}$};

          \path[->]
          (p0102) edge[dashed] node{$\tau$} (p01p)
          ;

          \node [initial, rectangle, draw, initial text=$P'_1\|P_2$:] (p'0102)
          at (10.3,-2) {$p'_{01}\|p_{02} \in E_{P'_1\|P_2}$};
        \end{tikzpicture}
        \caption{Gegenbeispiel für 1.\ von $\mathcal{R}_{12}$ bzgl.\
        Definition~\ref{SimDef} mit $a\in O_1\cap I_2$}
        \label{bsp1wSim}
      \end{center}
    \end{figure}

    \item Aus der Definition der schwachen alternierenden
      Simulation in~\ref{wSimDef} folgt, dass für diesen Punkt zu zeigen ist:
      $(p_1,p_2)\must[i]_{12}(q_1,q_2)$ impliziert $(p'_1,p_2)
      \must[i]_{P'_1\|P_2} \weakmust[\varepsilon]_{P'_1\|P_2} (q'_1,q_2)$
      für ein $(q'_1,q_2)$ mit $((q'_1,q_2),(q_1,q_2)) \in \mathcal{R}_{12}$.\\
      Die $i$-must"=Transition in $P_1\|P_2$ kann entweder aus der
      Synchronisation von zwei must"=Inputs entstanden sein oder als
      unsynchronisierte Aktion aus einem der komponierten \MEIO{}s übernommen
      worden sein.
      \begin{itemize}
        \item Fall 1 ($i\notin\Synch (P_1,P_2)$): Für den Fall $i$ in $I_2$ ist
          der Input in $P_2$ via must"=Transition ausführbar und somit sowohl
          in der Parallelkomposition $P'_1\|P_2$ wie auch in $P_1\|P_2$ als
          must"=Transition vorhanden. Es gilt dann auch $p_1=q_1$ und
          $p'_1=q'_1$, da $i$ kein Input von $P_1$ ist. Es gilt also die
          geforderte Transitionsfolge und das geforderte Element der Relation
          $\mathcal{R}_{12}$ direkt durch die Voraussetzungen.\\
          Für den Rest dieses Punktes wird davon ausgegangen, dass $i$ in $I_1$
          enthalten ist. Es muss also in $P_1$ die $i$-Transition als
          must"=Transition von $p_1$ ausgehen ($p_1\must[i]_1 q_1$). Mit
          der Relation $\mathcal{R}_1$ und~\ref{wSimDef}~2.\ folgt, dass in
          $P'_1$ $i$ als schwache Transition in der Form $p'_1\must[i]_{P'_1}
          \weakmust[\varepsilon]_{P'_1}q'_1$ ausführbar ist und $q'_1
          \mathcal{R}_1q_1$ gelten muss. $p_2=q_2 \in P_2$ muss erfüllt sein,
          da $i$ nicht in $\Sigma _2$ enthalten ist und $p_2$ nach
          Voraussetzung ein Zustand von $P_2$ sein muss. In der Komposition von
          $P'_1$ mit $P_2$ entsteht die Transitionsfolge $(p'_1,p_2)
          \must[i]_{P'_1\|P_2} \weakmust[\varepsilon]_{P'_1\|P_2} (q'_1,q_2)$.
          Mit der Definition von $\mathcal{R}_{12}$ kann daraus
          $((q'_1,q_2),(q_1,q_2)) \in \mathcal{R}_{12}$ gefolgert werden.
        \item Fall 2 ($i\in\Synch (P_1,P_2)$): Damit $i$ auch in $P_1\|P_2$
          ein Input ist, muss $i\in I_1\cap I_2$ gelten. Um die Transition
          $(p_1,p_2)\must[i]_{12}(q_1,q_2)$ in der Komposition möglich zu
          machen, muss in beiden Transitionssystemen $P_j$ $p_j\must[i]_j q_j$
          gelten. Durch $\mathcal{R}_1$ und die Definition~\ref{wSimDef}~2.\
          folgt $p'_1\must[i]_{P'_1} \weakmust[\varepsilon]_{P'_1}q'_1$ mit
          $(q'_1,q_1)\in\mathcal{R}_1$. Daraus ergibt sich
          $((q'_1,q_2),(q_1,q_2)) \in \mathcal{R}_{12}$ mit der Definition von
          $\mathcal{R}_{12}$. Durch die Synchronisation der $i$-Inputs von
          $P'_1$ und $P_2$ gilt $(p'_1,p_2) \must[i]_{P'_1\|P_2}
          \weakmust[\varepsilon]_{P'_1\|P_2} (q'_1,q_2)$.
      \end{itemize}
    \item Analog zu 2.\ kann für diesen Punkt $(p_1,p_2) \must[\omega]_{12}
      (q_1,q_2)$ impliziert $(p'_1,p_2) \weakmust[\hat{\omega}]_{P'_1\|P_2}
      (q'_1,q_2)$ für ein $(q'_1,q_2)$ mit $((q'_1,q_2),(q_1,q_2)) \in
      \mathcal{R}_{12}$ gezeigt werden.\\
      Die $\omega$-Transition in $P_1\|P_2$ ist entweder aus einem
      synchronisierten oder aus einem unsynchronisierten $\omega$ entstanden.
      \begin{itemize}
        \item Fall 1 ($\omega\notin\Synch (P_1,P_2)$): Der Fall $\omega$ ist
          eine Aktion, die in $P_2$ ausgeführt wird, verläuft analog zum Fall
          $i$ in $I_2$ im Fall 1 des zweiten Punkt dieses Beweises. Es sei also
          im folgenden $\omega$ ein Output oder eine interen Aktion von $P_1$.
          Um in der Komposition $P_1\|P_2$ die must"=Transition zu erhalten
          muss bereits für die Transition in $P_1$ $p_1 \must[\omega]_1 q_1$
          gelten sowie $p_2 = q_2$ in $P_2$. Mit~\ref{wSimDef}~3.\ kann für
          $\mathcal{R}_1$ gefolgert werden, dass $p'_1
          \weakmust[\hat{\omega}]_{P'_1} q'_1$ mit $(q'_1,q_1)\in\mathcal{R}_1$
          gilt. In der Komposition folgt dann $(p'_1,p_2)
          \weakmust[\hat{\omega}]_{P'_1\|P_2} (q'_1,q_2)$. Zusätzlich gilt auch
          die Zugehörigkeit des Zustands-Tupels $((q'_1,q_2),(q_1,q_2))$ zur
          Relation $\mathcal{R}_{12}$.
        \item Fall 2 ($\omega\in\Synch (P_1,P_2)$): Da in der Menge $\Synch
          (P_1,P_2)$ nur Inputs und Outputs enthalten sein können, muss in
          diesem Fall $\omega\neq\tau$ gelten. Um einen Output $\omega$ in der
          Parallelkomposition von $P_1$ und $P_2$ zu erhalten, muss entweder
          $\omega\in I_1\cap O_2$ oder $\omega\in O_1\cap I_2$ gelten. Für
          beide Fälle müssen die Transitionen $p_1\must[\omega]_1 q_1$ und
          $p_2\must[\omega]_2 q_2$ in den einzelnen Komponenten enthalten sein.
          Mit $\mathcal{R}_1$ und~\ref{wSimDef}~2.\ folgt im Fall $\omega\in
          I_1$ $p'_1\must[\omega]_{P'_1} \weakmust[\varepsilon]_{P'_1} q'_1$
          und $q'_1\mathcal{R}_1 q_1$. Im Fall $\omega\in O_1$ erhält man durch
          $\mathcal{R}_1$ und~\ref{wSimDef}~3.\ die Transition $p'_1
          \weakmust[\omega]_{P'_1} q'_1$ mit $q'_1\mathcal{R}_1 q_1$. Da
          $\omega$ in beiden Fällen keine interne Aktion ist, gilt $\omega
          =\hat{\omega}$. In der Parallelkomposition von $P'_1$ und $P_2$
          werden zuerst die internen Aktionen von $P'_1$ ausgeführt, falls
          diese existieren, bis dort die Aktion $\omega$ erreicht ist, dann
          wird $\omega$ synchronisiert und danach werden die restlichen
          internen Aktionen ausgeführt, bis man beim Zuständen $q_1$ angekommen
          ist. Es ergibt also die Transitionsfolge $(p'_1,p_2)
          \weakmust[\hat{\omega}]_{P'_1\|P_2} (q'_1,q_2)$ und das Tupel
          $((q'_1,q_2),(q_1,q_2))$ in der Relation $\mathcal{R}_{12}$.
      \end{itemize}
    \item $(p'_1,p_2)\may[i]_{P'_1\|P_2}(q'_1,q_2)$ impliziert $(p_1,p_2)
      \may[i]_{12} \weakmay[\varepsilon]_{12} (q_1,q_2)$ für ein $(q_1,q_2)$
      mit $((q'_1,q_2),(q_1,q_2))\in\mathcal{R}_{12}$ ist die Voraussetzung
      des 4.\ Punktes, um zu beweisen, dass $\mathcal{R}_{12}$ eine schwache
      as"=Verfeinerungs"=Relation, bis auf die Erfüllung von 1.\ aus der
      Definition~\ref{wSimDef}, ist.\\
      Die Transition $i$ kann durch Synchronisation von zwei
      Transitionen entstanden sein oder durch eine Transition aus einer der
      beiden Komponenten mit der Voraussetzung $i\notin\Synch (P'_1,P_2)$.
      \begin{itemize}
        \item Fall 1 ($i\notin\Synch (P'_1,P_2)$): Der Fall $i$ in $I_2$
          verläuft analog zum selben Fall im Fall 1 des Beweis des zweiten
          Punktes. Es muss nur must durch may ersetzt werden. Es kann also für
          den Rest diese Punktes davon ausgegangen werden, dass $i$ in $I_1$
          enthalten ist. Es muss in $P'_1$ eine ausgehende $i$-Transition von
          Zustand $p'_1$ geben, so dass $p'_1\may[i]_1 q'_1$ gilt. Mit der
          Relation $\mathcal{R}_1$ und~\ref{wSimDef}~4.\ folgt, dass in $P_1$
          $i$ als schwache Transition der Form $p_1\may[i]_1
          \weakmay[\varepsilon]_1 q_1$ ausführbar sein und $q'_1 \mathcal{R}_1
          q_1$ gelten muss. Mit der Definition von $\mathcal{R}_{12}$ kann dann
          $((q'_1,q_2),(q_1,q_2)) \in \mathcal{R}_{12}$ gefolgert werden. In
          der Parallelkomposition von $P_1$ und $P_2$ entsteht die
          Transitionsfolge $(p_1,p_2)\may[i]_{12} \weakmay[\varepsilon]_{12}
          (q_1,q_2)$.
        \item Fall 2 ($i\in\Synch (P'_1,P_2)$): Damit $i$ auch in
          $P'_1\|P_2$ ein Input ist, muss $i\in I_1\cap I_2$ gelten. Um die
          Transition $(p'_1,p_2)\may[i]_{P'_1\|P_2}(q'_1,q_2)$ in der
          Komposition möglich zu machen, muss in den Transitionssystemen
          $P'_1$ und $P_2$ $p'_1 \may[i]_{P'_1} q'_1$ bzw.\ $p_2\may[i]_2 q_2$
          gelten. Durch $\mathcal{R}_1$ und die Definition~\ref{wSimDef}~4.,
          die für diese Relation gilt, folgt $p_1\may[i]_1
          \weakmay[\varepsilon]_1 q_1$ mit $(q'_1,q_1)\in\mathcal{R}_1$. Es
          gilt also $((q'_1,q_2),(q_1,q_2)) \in \mathcal{R}_{12}$. Durch die
          Synchronisation des Inputs $i$ in der Komposition von $P_1$ und $P_2$
          ergibt sich $(p_1,p_2) \may[i]_{12} \weakmay[\varepsilon]_{12}
          (q_1,q_2)$.
      \end{itemize}
    \item Analog zu 3.\ und 4.\ kann für diesen Punkt $(p'_1,p_2)
      \may[\omega]_{P'_1\|P_2} (q'_1,q_2)$ impliziert $(p_1,p_2)
      \weakmay[\hat{\omega}]_{12} (q_1,q_2)$ für ein $(q_1,q_2)$ mit
      $((q'_1,q_2),(q_1,q_2))\in\mathcal{R}_{12}$ gezeigt werden.\\
      Die $\omega$ Transition in $P'_1\|P_2$ ist entweder aus einem
      synchronisierten oder aus einem unsynchronisierten $\omega$ entstanden.
      \begin{itemize}
        \item Fall 1 ($\omega\notin\Synch (P'_1,P_2)$): Im Fall $\omega$ ist
          eine Aktion von $P_2$ folgt das zu zeigende direkt aus den
          Voraussetzungen, ebenso wie in allen vorangegangenen Punkten. Somit
          wird im folgenden davon ausgegangen, dass $\omega$ in $O_1$ enthalten
          oder eine interne Aktion ist, die von $P'_1$ geerbt wurde. Um in
          $P'_1\|P_2$ die may"=Transition zu erhalten muss bereits in $P'_1$
          die Transition $p'_1 \may[\omega]_{P'_1} q'_1$ möglich gewesen sein.
          Mit~\ref{wSimDef}~5.\ kann für $\mathcal{R}_1$ gefolgert werden, dass
          $p_1 \weakmay[\hat{\omega}]_1 q_1$ mit $(q'_1,q_1) \in \mathcal{R}_1$
          gilt. Für die Komposition folgt daraus $(p_1,p_2)
          \weakmay[\hat{\omega}]_{12} (q_1,q_2)$. Es gilt auch die
          Zugehörigkeit des Zustands-Tupels $((q'_1,q_2),(q_1,q_2))$ zur
          Relation $\mathcal{R}_{12}$.
        \item Fall 2 ($\omega\in\Synch (P'_1,P_2)$): Es muss $\omega\neq\tau$
          gelten und somit können die Fälle $\omega\in I_1\cap O_2$ und
          $\omega\in O_1\cap I_1$ unterschieden werden. Es folgt in beiden
          Fällen $p'_1\may[\omega]_{P'_1} q'_1$ und $p_2 \may[\omega]_2
          q_2$. Mit $\mathcal{R}_1$ und~\ref{wSimDef}~4.\ folgt im Fall
          $\omega\in I_1$ $p_1\may[\omega]_1 \weakmay[\varepsilon]_1 q_1$ und
          $q'_1 \mathcal{R}_1 q_1$. Im Fall $\omega\in O_1$ wendet man
          $\mathcal{R}_1$ mit~\ref{wSimDef}~5.\ an und erhält $p_1
          \weakmay[\omega]_1 q_1$ und $q'_1\mathcal{R}_1 q_1$. Da $\omega$
          eine sichtbare Aktion ist, gilt $\omega =\hat{\omega}$. In der
          Parallelkomposition von $P_1$ und $P_2$ werden zuerst mögliche
          internen Aktionen von $P_1$ ausgeführt, bis dort die sichtbare Aktion
          erreicht ist, dann wird $\omega$ synchronisiert und danach werden die
          restlichen internen Aktionen ausgeführt, bis man beim Zustand
          $q_1$ angekommen ist. Es ergibt sich also die Transitionsfolge
          $(p_1,p_2) \weakmay[\hat{\omega}]_{12} (q_1,q_2)$ und das Tupel
          $((q'_1,q_2),(q_1,q_2))$ in der Relation $\mathcal{R}_{12}$.
      \end{itemize}
  \end{enumerate}
\end{proof}

\begin{Kor}[as-Verfeinerungen und Parallelkomposition]
  \label{verfParallelKor}
  Für zwei komponierbar \MEIO{}s $P_1$ und $P_2$ gilt, falls $P'_1$ eine
  as"=Verfeinerung von $P_1$ ist, dann ist auch $P'_1\|P_2$ eine
  as"=Verfeinerung von $P_1\|P_2$.
\end{Kor}
\begin{proof}
  Falls die Relation $\mathcal{R}_1$ aus dem Lemma~\ref{schwVerfParallelLem}
  keine schwachen as"=Verfeinerungs"=Relation sondern eine starke
  as"=Verfeinerungs"=Relation ist, ist auch $\mathcal{R}_{12}$ eine
  as"=Verfeinerungs"=Relation zwischen $P'_1\|P_2$ und $P_1\|P_2$. Es ist also
  nur zu zeigen, wie aus den einzelnen Beweispunkten des Beweises
  von~\ref{schwVerfParallelLem} folgt, dass $\mathcal{R}_{12}$ eine starke
  as"=Verfeinerungs"=Relation ist und dass hier zusätzlich der erste Punkt
  erfüllt ist. Es wird hier ebenso für alle Punkte vorausgesetzt, dass
  $((p'_1,p_2),(p_1,p_2))\in\mathcal{R}_{12}$ mit $(p_1,p_2)\notin E_{12}$
  gilt.
  \begin{enumerate}
    \item Dieser Punkt kann im Gegensatz zu 1.\ aus dem Beweis von
      Lemma~\ref{schwVerfParallelLem} bewiesen werden. Dies ist möglich, da für
      $p_1$ im Falle eines Outputs $a$ dieser nicht nur schwach sondern direkt
      ausführbar ist. Es ist also zu zeigen, dass $(p'_1,p_2)$ kein Element von
      $E_{P'_1\|P_2}$ ist.\\
      Dies folgt direkt aus der Voraussetzung, dass $(p_1,p_2)\notin
      E_{P_1\|P_2}$ für das Tupel $((p'_1,p_2),(p_1,p_2))$ aus
      $\mathcal{R}_{12}$ gilt. In dem man auf das $\mathcal{R}_{12}$ die
      Definition anwendet, erhält man $(p'_1,p_1)\in\mathcal{R}_1$ und $p_2\in
      P_2$. Die $p_j$ dürfen beide keine Fehler-Zustände sein, da sonst auch
      $(p_1,p_2)$ ein solcher wäre. Somit folgt mit Definition~\ref{SimDef}~1.\
      $p'_1\notin E_{P'_1}$. Die Zustände $p'_1$ und $p_2$ in
      Parallelkomposition können also keinen geerbten Fehler produzieren.
      Jedoch könnte $(p'_1,p_2)$ aufgrund eines nicht sichergestellten Inputs
      ein neuer Fehler-Zustand sein. Dafür müsste entweder $p'_1
      \nmust[a]_{P'_1}$ und $p_2\may[a]_2$ für ein $a$ aus $I_1\cap O_2$ oder
      $p'_1\may[a]_{P'_1}$ und $p_2\nmust[a]_2$ für ein $a$ aus $O_1\cap I_2$
      gelten. Mit~\ref{SimDef}~2.\ und $\mathcal{R}_1$ folgt im Fall $a\in I_1$
      $p_1 \nmust[a]_1$. $\mathcal{R}_1$ erzwingt mit~\ref{SimDef}~3.\ die
      direkte Ausführbarkeit des Outputs $a$ in $P_1$ im Fall $a\in O_1$, d.h.\
      $p_1 \may[a]_1$. Somit müsste auch $(p_1,p_2)\in E_{12}$ in beiden Fällen
      gelten, was ein Widerspruch zur Voraussetzung wäre. $(p'_1,p'_2)$ kann
      also weder ein geerbter noch ein neuer Fehler in $P'_1\|P_2$ sein und
      deshalb gilt $(p'_1,p_2) \notin E_{P'_1\|P_2}$.
    \item $\alpha$ kann sowohl Input, Output wie auch interen Aktion sein. Um
      diesen Punkt zu beweisen muss man 2.\ und 3.\ aus dem Beweis von
      Lemma~\ref{schwVerfParallelLem} kombinieren. Da $\mathcal{R}_1$ die
      Transition in $P'_1$ ohne zusätzliche $\tau$-Transitionen fordern,
      entstehen keine schwachen Transitionen für die $\alpha$s und somit ist
      $\alpha$ auch in der Parallelkomposition $P'_1\|P_2$ eine direkte
      Transition ohne zusätzliche $\tau$s. Es folgt das $\mathcal{R}_{12}$ die
      Forderungen für die strake as"=Verfeinerungs"=Relation dieses Punktes
      erfüllt.
    \item Hierfür werden die Punkte 3.\ und 4.\ aus dem Beweis des
      Lemmas~\ref{schwVerfParallelLem} kombiniert. Analog wie bei 2.\ diese
      Beweises fallen die zusätzlichen $\tau$-Transitionen durch die stärkere
      Forderung an $\mathcal{R}_1$ weg. Dieser Punkt gilt also ebenfalls.
  \end{enumerate}
\end{proof}

Das Lemma~\ref{schwVerfParallelLem} und das Korollar~\ref{verfParallelKor}
fordern jeweils nur die Verfeinerung der ersten Komponente. Da die
Parallelkomposition so definiert wurde, dass sie kommutativ ist, ist ebenso die
Verfeinerung der zweiten Komponente möglich. Da man beide Komponenten nach
einander verfeinern kann und jede Verfeinerung einer Verfeinerung auch eine
Verfeinerung das ursprünglichen Systems ist, kann man auch beide Komponenten
gleichzeitig verfeinern und erhält in der Parallelkomposition eine Verfeinerung
der ursprünglichen Systeme in Komposition.

\begin{Kor}[as-Implementierungen und Parallelkomposition]
  \label{ImpParallelKor}
  Für zwei komponierbare \MEIO{}s $P_1$ und $P_2$ gilt:
  $P'_1\in\asimp (P_1) \land P'_2 \in\asimp (P_2) \Rightarrow (P'_1\|P'_2)
  \in\asimp (P_1\|P_2)$.
\end{Kor}
\begin{proof}
  $P'_1$ und $P'_2$ sind aufgrund der Definition~\ref{SimDef} auch starke
  as"=Verfeinerungen von $P_1$ bzw.\ $P_2$. Somit ist die Parallelkomposition
  $P'_1\|P'_2$ auch eine starke as"=Verfeinerung von $P_1\|P_2$, wegen
  Korollar~\ref{verfParallelKor}. Für Implementierungen gilt $\must =\may$.
  Durch die Definition der Parallelkomposition in~\ref{ParallelDef} können
  aus zwei komponierbaren Implementierungen in der Komposition keine
  may"=Transitionen ohne zugehörige must"=Transitionen entstehen. Es gilt also
  auch $\must _{P'_1\|P'_2} =\may _{P'_1\|P'_2}$ und somit ist $P'_1\|P'_2$
  eine Implementierung und eine as"=Verfeinerung von $P_1\|P_2$. Dies
  entspricht der Definition der starken as"=Implementierung, sodass
  $(P'_1\|P'_2)\in\asimp (P_1\|P_2)$ gilt.
\end{proof}

Für schwache as"=Implementierungen kann es kein analoges Korollar
zur~\ref{ImpParallelKor} gegen, da die Verfeinerung bereits scheitert
(Lemma~\ref{schwVerfParallelLem}).\\
Die entgegengesetzte Richtung von Korollar~\ref{verfParallelKor} gilt im
allgemeinen nicht, d.h.\ es muss zu einer as"=Verfeinerung $P'$ einer
Parallelkomposition $P_1\|P_2$ keine as"=Verfeinerungen $P'_1$ und $P'_2$ der
einzelnen Komponenten geben, deren Parallelkomposition $P'_1\|P'_2$ der
as"=Verfeinerung der Parallelkomposition $P'$ entsprechen. Die Problematik wird
in Abbildung~\ref{impParallelFig} an einem Beispiel dargestellt. In der
Parallelkomposition wird die may"=Transition von $P_2$ zu zwei
may"=Transitionen, für die in einer as"=Verfeinerung unabhängig entschieden
werden kann, ob sie übernommen, implementiert oder weggelassen werden. Somit
kommt es in $P'$ zu dem Problem, dass keine as"=Verfeinerung von $P_2$
(entweder keine Transition oder die $o'$ Transition wird als may- oder
must-Transition ausgeführt) in Parallelkomposition mit der Implementierung
$P_1$ $P'$ ergeben würde.\\
Auch im Spezialfall von as"=Implementierungen kann das Gegenbeispiel angewendet
werden, da $P'$ auch eine Implementierung von $P_1\|P_2$ ist und es auch keine
passende as"=Implementierung von $P_2$ geben kann, wenn es schon keine passende
Verfeinerung gibt.

\begin{figure}[htbp]
  \begin{center}
    \begin{tikzpicture}[shorten >=1pt,auto,node distance=2.5cm]
      \node [initial,initial text=$P_1$:] (p01) at (0,0) {$p_{01}$};
      \node (p1) [right of=p01] {$p_1$};

      \path[->]
      (p01) edge node{$o!$} (p1)
      ;

      \node [initial,initial text=$P_2$:] (p02) at (7,0) {$p_{02}$};
      \node (p2) [right of=p02] {$p_2$};

      \path[->]
      (p02) edge[dashed] node{$o'!$} (p2)
      ;

      \node [initial,initial text=$P_1\|P_2$:] (p0) at (0,-2)
      {$p_{01}\|p_{02}$};
      \node (p102) [right of=p0] {$p_1\|p_{02}$};
      \node (p012) [below of=p0] {$p_{01}\|p_2$};
      \node (p12) [below of=p102] {$p_1\|p_2$};

      \path[->]
      (p0) edge node{$o!$} (p102)
      (p012) edge node{$o!$} (p12)
      (p0) edge[dashed] node{$o'!$} (p012)
      (p102) edge[dashed] node{$o'!$} (p12)
      ;

      \node [initial,initial text=$P'$:] (p'0) at (7,-2)
      {$p'_{01}\|p'_{02}$};
      \node (p'102) [right of=p'0] {$p'_1\|p'_{02}$};
      \node (p'012) [below of=p'0] {$p'_{01}\|p'_2$};
      \node (p'12) [below of=p'102] {$p'_1\|p'_2$};

      \path[->]
      (p'0) edge node{$o!$} (p'102)
      (p'012) edge node{$o!$} (p'12)
      (p'0) edge node{$o'!$} (p'012)
      ;
    \end{tikzpicture}
    \caption{Gegenbeispiel für Umkehrung von Lemma~\ref{verfParallelKor}}
    \label{impParallelFig}
  \end{center}
\end{figure}

Ein neuer Fehler in einer Parallelkomposition zweier \MEIO{}s
muss in einer Implementierung (as oder w-as) dieser Parallelkomposition nicht
auftauchen, auch nicht in der Parallelkomposition von Implementierungen der
einzelnen Komponenten. Dies liegt daran, dass für den Input nur vorausgesetzt
wird, dass keine must"=Transition für die Synchronisation der Aktion vorhanden
ist. Es kann trotzdem eine may"=Transition für den Input geben, die auch
implementiert werden kann. Falls es aber in der Parallelkomposition zweier
\MEIO{} zu einem neuen Fehler kommt, dann gibt es auch immer mindestens eine
mögliche Implementierung, die diesen Fehler enthält und es gibt auch immer
mindestens ein Implementierungs-Paar der Komponenten, in deren
Parallelkomposition sich dieser Fehler ebenfalls zeigt.
